<!doctype html>


<hr style="margin:24px 0; border:none; border-top:1px solid #eee;">
<p class="muted">Prefer WhatsApp? <a id="wa" href="https://wa.me/447894072678?text=I%20have%20a%20lock%20issue" target="_blank">Tap here to message us</a> or call $1+44 7894 072678$3.</p>
</div>
</div>
<script>
const API_URL = 'https://script.google.com/macros/s/AKfycbzQawpw1puLgRdR17vqPRAtIGjBknZGcTbGDH-4tcp6ez_jaA_cnJVcvAiriR7-8Xh7jw/exec';
const form = document.getElementById('f');
const msg = document.getElementById('msg');


form.addEventListener('submit', async (e)=>{
e.preventDefault();
msg.textContent = 'Sending…';


// Convert up to 3 photos to data URLs (base64)
const files = Array.from(document.getElementById('photos').files).slice(0,3);
const photos = await Promise.all(files.map(f => new Promise(res=>{
const r = new FileReader();
r.onload = ()=>res(r.result);
r.readAsDataURL(f);
})));


const payload = {
source: 'web',
name: document.getElementById('name').value.trim(),
mobile: document.getElementById('mobile').value.trim(),
postcode: document.getElementById('postcode').value.trim(),
doorType: document.getElementById('doorType').value,
problem: document.getElementById('problem').value,
symptoms: document.getElementById('symptoms').value.trim(),
urgency: document.getElementById('urgency').value,
access: document.getElementById('access').value.trim(),
photos
};


try{
const r = await fetch(API_URL, {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
const j = await r.json();
if(j.ok){
msg.innerHTML = '<span class="ok">Thanks! We\'ve got your details and will reply shortly.</span>';
form.reset();
}else{
msg.innerHTML = '<span class="err">Sorry, something went wrong. Please WhatsApp or call us.</span>';
}
}catch(err){
msg.innerHTML = '<span class="err">Network error — please WhatsApp or call us.</span>';
}
});
</script>
</body>
</html>
